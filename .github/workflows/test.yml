name: Generate SVGs

on:
  workflow_dispatch:
  push:
    branches:
      - main # Replace with your default branch if not 'main'

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Make directory for SVGs
      run: mkdir -p ./projects_cards

    - name: Generate SVGs from Express server
      run: |
        for i in $(seq 1 9); do  # Adjust the range according to the number of projects you have
          curl "https://github.bankkroll.repl.co/generatecard/$i" > ./projects_cards/project_$i.svg
        done

    - name: Commit and push SVGs
      run: |
        git config --global user.name 'GitHub Action'
        git config --global user.email 'action@github.com'
        git add ./projects_cards/*
        git commit -m "Automatically generated SVGs"
        git push
